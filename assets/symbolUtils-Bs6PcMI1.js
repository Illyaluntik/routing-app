const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/visualVariableUtils-xAbbuuJf.js","assets/index-CExwPuvJ.js","assets/index-UDJfKx5H.css"])))=>i.map(i=>d[i]);
import{bm as g,k6 as _,aQ as A,_ as L}from"./index-CExwPuvJ.js";import{L as b,M as O,N as F}from"./utils-Cjd6Y7st.js";import"./colorUtils-Da-Azb5s.js";import"./defaults3D-C8qVkuBx.js";var r;(function(e){e[e.size=22]="size",e[e.lineWidth=50]="lineWidth",e[e.maxSize=120]="maxSize",e[e.maxOutlineSize=80]="maxOutlineSize",e[e.tallSymbolWidth=20]="tallSymbolWidth"})(r||(r={}));const f=g("android");g("chrome")||f&&f>=4;_();r.size;r.maxSize;r.maxOutlineSize;r.lineWidth;r.tallSymbolWidth;function w(e){return e&&"opacity"in e?e.opacity*w(e.parent):1}async function E(e,i){if(!e)return;const h=e.sourceLayer,p=(i!=null&&i.useSourceLayer?h:e.layer)??h,o=i?.ignoreOpacity?1:w(p);if(e.symbol!=null&&(i==null||i.ignoreGraphicSymbol!==!0)){const l=e.symbol.type==="web-style"?await e.symbol.fetchSymbol({...i,acceptedFormats:i?.webStyleAcceptedFormats,cache:i?.webStyleCache}):e.symbol.clone();return b(l,null,o),l}const t=i?.renderer??W(p);let a=t&&"getSymbolAsync"in t?await t.getSymbolAsync(e,i):null;if(!a)return;if(a=a.type==="web-style"?await a.fetchSymbol({...i,acceptedFormats:i?.webStyleAcceptedFormats,cache:i?.webStyleCache}):a.clone(),!t||!("visualVariables"in t)||!t.visualVariables?.length)return b(a,null,o),a;if("arcadeRequiredForVisualVariables"in t&&t.arcadeRequiredForVisualVariables&&i?.arcade==null){const l={...i};l.arcade=await A(),i=l}const{getColor:z,getOpacity:V,getAllSizes:x,getRotationAngle:v}=await L(()=>import("./visualVariableUtils-xAbbuuJf.js").then(l=>l.b),__vite__mapDeps([0,1,2])),s=[],c=[],u=[],d=[];for(const l of t.visualVariables)switch(l.type){case"color":s.push(l);break;case"opacity":c.push(l);break;case"rotation":d.push(l);break;case"size":l.target||u.push(l)}const S=!!s.length&&s[s.length-1],y=S?z(S,e,i):null,m=!!c.length&&c[c.length-1];let n=m?V(m,e,i):null;if(o!=null&&(n=n!=null?n*o:o),i?.ignoreOpacity&&(n=1),y!=null&&m&&n!=null&&(y.a=1),b(a,y,n),u.length&&i?.ignoreSizeVariables!==!0){const l=x(u,e,i);await O(a,l)}if(i?.ignoreRotationVariables!==!0)for(const l of d)F(a,v(l,e,i),l.axis);return a}function W(e){if(e)return"renderer"in e?e.renderer:void 0}export{E as x};
